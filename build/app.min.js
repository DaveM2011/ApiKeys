!function(){"use strict";function t(t,e){return e={exports:{}},t(e,e.exports),e.exports}var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=t(function(t){!function(){function n(t,e,n,r,i,o){return{tag:t,key:e,attrs:n,children:r,text:i,dom:o,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}function r(t){var e,r=arguments[1],l=2;if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");if("string"==typeof t)var u=o[t]||function(t){for(var e,n="div",r=[],a={};e=i.exec(t);){var l=e[1],u=e[2];if(""===l&&""!==u)n=u;else if("#"===l)a.id=u;else if("."===l)r.push(u);else if("["===e[3][0]){var s=e[6];s&&(s=s.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?r.push(s):a[e[4]]=""===s?s:s||!0}}return r.length>0&&(a.className=r.join(" ")),o[t]={tag:n,attrs:a}}(t);if(null==r?r={}:("object"!=typeof r||null!=r.tag||Array.isArray(r))&&(r={},l=1),arguments.length===l+1)e=arguments[l],Array.isArray(e)||(e=[e]);else for(e=[];l<arguments.length;)e.push(arguments[l++]);var s=n.normalizeChildren(e);return"string"==typeof t?function(t,e,r){var i,o,l=!1,u=e.className||e.class;for(var s in t.attrs)a.call(t.attrs,s)&&(e[s]=t.attrs[s]);void 0!==u&&(void 0!==e.class&&(e.class=void 0,e.className=u),null!=t.attrs.className&&(e.className=t.attrs.className+" "+u));for(var s in e)if(a.call(e,s)&&"key"!==s){l=!0;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?o=r[0].children:i=r,n(t.tag,e.key,l?e:void 0,i,o)}(u,r,s):n(t,r.key,r,s)}n.normalize=function(t){return Array.isArray(t)?n("[",void 0,void 0,n.normalizeChildren(t),void 0,void 0):null!=t&&"object"!=typeof t?n("#",void 0,void 0,!1===t?"":t,void 0,void 0):t},n.normalizeChildren=function(t){for(var e=0;e<t.length;e++)t[e]=n.normalize(t[e]);return t};var i=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,o={},a={}.hasOwnProperty;r.trust=function(t){return null==t&&(t=""),n("<",void 0,void 0,t,void 0,void 0)},r.fragment=function(t,e){return n("[",t.key,t,n.normalizeChildren(e),void 0,void 0)};var l=r;if((u=function(t){function e(t,e){return function a(u){var f;try{if(!e||null==u||"object"!=typeof u&&"function"!=typeof u||"function"!=typeof(f=u.then))c(function(){e||0!==t.length||console.error("Possible unhandled promise rejection:",u);for(var n=0;n<t.length;n++)t[n](u);i.length=0,o.length=0,s.state=e,s.retry=function(){a(u)}});else{if(u===r)throw new TypeError("Promise can't be resolved w/ itself");n(f.bind(u))}}catch(t){l(t)}}}function n(t){function e(t){return function(e){n++>0||t(e)}}var n=0,r=e(l);try{t(e(a),r)}catch(t){r(t)}}if(!(this instanceof u))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var r=this,i=[],o=[],a=e(i,!0),l=e(o,!1),s=r._instance={resolvers:i,rejectors:o},c="function"==typeof setImmediate?setImmediate:setTimeout;n(t)}).prototype.then=function(t,e){function n(t,e,n,a){e.push(function(e){if("function"!=typeof t)n(e);else try{r(t(e))}catch(t){i&&i(t)}}),"function"==typeof o.retry&&a===o.state&&o.retry()}var r,i,o=this._instance,a=new u(function(t,e){r=t,i=e});return n(t,o.resolvers,r,!0),n(e,o.rejectors,i,!1),a},u.prototype.catch=function(t){return this.then(null,t)},u.resolve=function(t){return t instanceof u?t:new u(function(e){e(t)})},u.reject=function(t){return new u(function(e,n){n(t)})},u.all=function(t){return new u(function(e,n){var r=t.length,i=0,o=[];if(0===t.length)e([]);else for(var a=0;a<t.length;a++)!function(a){function l(t){i++,o[a]=t,i===r&&e(o)}null==t[a]||"object"!=typeof t[a]&&"function"!=typeof t[a]||"function"!=typeof t[a].then?l(t[a]):t[a].then(l,n)}(a)})},u.race=function(t){return new u(function(e,n){for(var r=0;r<t.length;r++)t[r].then(e,n)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=u);u=window.Promise}else if(void 0!==e){void 0===e.Promise&&(e.Promise=u);var u=e.Promise}var s=function(t){function e(t,r){if(Array.isArray(r))for(i=0;i<r.length;i++)e(t+"["+i+"]",r[i]);else if("[object Object]"===Object.prototype.toString.call(r))for(var i in r)e(t+"["+i+"]",r[i]);else n.push(encodeURIComponent(t)+(null!=r&&""!==r?"="+encodeURIComponent(r):""))}if("[object Object]"!==Object.prototype.toString.call(t))return"";var n=[];for(var r in t)e(r,t[r]);return n.join("&")},c=new RegExp("^file://","i"),f=function(t,e){function n(){function t(){0==--e&&"function"==typeof f&&f()}var e=0;return function n(r){var i=r.then;return r.then=function(){e++;var o=i.apply(r,arguments);return o.then(t,function(n){if(t(),0===e)throw n}),n(o)},r}}function r(t,e){if("string"==typeof t){var n=t;null==(t=e||{}).url&&(t.url=n)}return t}function i(t,e){if(null==e)return t;for(var n=t.match(/:[^\/]+/gi)||[],r=0;r<n.length;r++){var i=n[r].slice(1);null!=e[i]&&(t=t.replace(n[r],e[i]))}return t}function o(t,e){var n=s(e);return""!==n&&(t+=(t.indexOf("?")<0?"?":"&")+n),t}function a(t){try{return""!==t?JSON.parse(t):null}catch(e){throw new Error(t)}}function l(t){return t.responseText}function u(t,e){if("function"==typeof t){if(!Array.isArray(e))return new t(e);for(var n=0;n<e.length;n++)e[n]=new t(e[n])}return e}var f,d=0;return{request:function(s,f){var d=n();s=r(s,f);var h=new e(function(e,n){null==s.method&&(s.method="GET"),s.method=s.method.toUpperCase();var r="GET"!==s.method&&"TRACE"!==s.method&&("boolean"!=typeof s.useBody||s.useBody);"function"!=typeof s.serialize&&(s.serialize="undefined"!=typeof FormData&&s.data instanceof FormData?function(t){return t}:JSON.stringify),"function"!=typeof s.deserialize&&(s.deserialize=a),"function"!=typeof s.extract&&(s.extract=l),s.url=i(s.url,s.data),r?s.data=s.serialize(s.data):s.url=o(s.url,s.data);var f=new t.XMLHttpRequest,d=!1,h=f.abort;f.abort=function(){d=!0,h.call(f)},f.open(s.method,s.url,"boolean"!=typeof s.async||s.async,"string"==typeof s.user?s.user:void 0,"string"==typeof s.password?s.password:void 0),s.serialize!==JSON.stringify||!r||s.headers&&s.headers.hasOwnProperty("Content-Type")||f.setRequestHeader("Content-Type","application/json; charset=utf-8"),s.deserialize!==a||s.headers&&s.headers.hasOwnProperty("Accept")||f.setRequestHeader("Accept","application/json, text/*"),s.withCredentials&&(f.withCredentials=s.withCredentials);for(var v in s.headers)({}).hasOwnProperty.call(s.headers,v)&&f.setRequestHeader(v,s.headers[v]);"function"==typeof s.config&&(f=s.config(f,s)||f),f.onreadystatechange=function(){if(!d&&4===f.readyState)try{var t=s.extract!==l?s.extract(f,s):s.deserialize(s.extract(f,s));if(f.status>=200&&f.status<300||304===f.status||c.test(s.url))e(u(s.type,t));else{var r=new Error(f.responseText);for(var i in t)r[i]=t[i];n(r)}}catch(t){n(t)}},r&&null!=s.data?f.send(s.data):f.send()});return!0===s.background?h:d(h)},jsonp:function(a,l){var s=n();a=r(a,l);var c=new e(function(e,n){var r=a.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+d++,l=t.document.createElement("script");t[r]=function(n){l.parentNode.removeChild(l),e(u(a.type,n)),delete t[r]},l.onerror=function(){l.parentNode.removeChild(l),n(new Error("JSONP request failed")),delete t[r]},null==a.data&&(a.data={}),a.url=i(a.url,a.data),a.data[a.callbackKey||"callback"]=r,l.src=o(a.url,a.data),t.document.documentElement.appendChild(l)});return!0===a.background?c:s(c)},setCompletionCallback:function(t){f=t}}}(window,u),d=function(t){function e(t){return t.attrs&&t.attrs.xmlns||A[t.tag]}function r(t,e,n,r,o,a,l){for(var u=n;u<r;u++){var s=e[u];null!=s&&i(t,s,o,l,a)}}function i(t,l,u,s,c){var h=l.tag;if("string"!=typeof h)return function(t,e,n,r,o){{if(a(e,n),null!=e.instance){var l=i(t,e.instance,n,r,o);return e.dom=e.instance.dom,e.domSize=null!=e.dom?e.instance.domSize:0,f(t,l,o),l}return e.domSize=0,S}}(t,l,u,s,c);switch(l.state={},null!=l.attrs&&w(l.attrs,l,u),h){case"#":return function(t,e,n){return e.dom=_.createTextNode(e.children),f(t,e.dom,n),e.dom}(t,l,c);case"<":return o(t,l,c);case"[":return function(t,e,n,i,o){var a=_.createDocumentFragment();if(null!=e.children){var l=e.children;r(a,l,0,l.length,n,null,i)}return e.dom=a.firstChild,e.domSize=a.childNodes.length,f(t,a,o),a}(t,l,u,s,c);default:return function(t,i,o,a,l){var u=i.tag,s=i.attrs,c=s&&s.is,h=(a=e(i)||a)?c?_.createElementNS(a,u,{is:c}):_.createElementNS(a,u):c?_.createElement(u,{is:c}):_.createElement(u);i.dom=h,null!=s&&function(t,e,n){for(var r in e)y(t,r,null,e[r],n)}(i,s,a);if(f(t,h,l),null!=i.attrs&&null!=i.attrs.contenteditable)d(i);else if(null!=i.text&&(""!==i.text?h.textContent=i.text:i.children=[n("#",void 0,void 0,i.text,void 0,void 0)]),null!=i.children){var v=i.children;r(h,v,0,v.length,o,null,a),function(t){var e=t.attrs;"select"===t.tag&&null!=e&&("value"in e&&y(t,"value",null,e.value,void 0),"selectedIndex"in e&&y(t,"selectedIndex",null,e.selectedIndex,void 0))}(i)}return h}(t,l,u,s,c)}}function o(t,e,n){var r={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(e.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",i=_.createElement(r);i.innerHTML=e.children,e.dom=i.firstChild,e.domSize=i.childNodes.length;for(var o,a=_.createDocumentFragment();o=i.firstChild;)a.appendChild(o);return f(t,a,n),a}function a(t,e){var r;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(r=t.state.view).$$reentrantLock$$)return S;r.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(r=t.tag).$$reentrantLock$$)return S;r.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(t._state=t.state,null!=t.attrs&&w(t.attrs,t,e),w(t._state,t,e),t.instance=n.normalize(t._state.view.call(t.state,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}function l(t,e,n,o,a,l,d){if(e!==n&&(null!=e||null!=n))if(null==e)r(t,n,0,n.length,a,l,d);else if(null==n)h(e,0,e.length,n);else{if(e.length===n.length){for(var v=!1,p=0;p<n.length;p++)if(null!=n[p]&&null!=e[p]){v=null==n[p].key&&null==e[p].key;break}if(v){for(p=0;p<e.length;p++)e[p]!==n[p]&&(null==e[p]&&null!=n[p]?i(t,n[p],a,d,c(e,p+1,l)):null==n[p]?h(e,p,p+1,n):u(t,e[p],n[p],a,c(e,p+1,l),o,d));return}}if(o=o||function(t,e){if(null!=t.pool&&Math.abs(t.pool.length-e.length)<=Math.abs(t.length-e.length)){var n=t[0]&&t[0].children&&t[0].children.length||0,r=t.pool[0]&&t.pool[0].children&&t.pool[0].children.length||0,i=e[0]&&e[0].children&&e[0].children.length||0;if(Math.abs(r-i)<=Math.abs(n-i))return!0}return!1}(e,n)){var m=e.pool;e=e.concat(e.pool)}for(var y,g=0,b=0,w=e.length-1,k=n.length-1;w>=g&&k>=b;){if((x=e[g])!==(_=n[b])||o)if(null==x)g++;else if(null==_)b++;else if(x.key===_.key){C=null!=m&&g>=e.length-m.length||null==m&&o;b++,u(t,x,_,a,c(e,++g,l),C,d),o&&x.tag===_.tag&&f(t,s(x),l)}else{if((x=e[w])!==_||o)if(null==x)w--;else if(null==_)b++;else{if(x.key!==_.key)break;C=null!=m&&w>=e.length-m.length||null==m&&o;u(t,x,_,a,c(e,w+1,l),C,d),(o||b<k)&&f(t,s(x),c(e,g,l)),w--,b++}else w--,b++}else g++,b++}for(;w>=g&&k>=b;){var x=e[w],_=n[k];if(x!==_||o)if(null==x)w--;else if(null==_)k--;else if(x.key===_.key){C=null!=m&&w>=e.length-m.length||null==m&&o;u(t,x,_,a,c(e,w+1,l),C,d),o&&x.tag===_.tag&&f(t,s(x),l),null!=x.dom&&(l=x.dom),w--,k--}else{if(y||(y=function(t,e){for(var n={},r=0,r=0;r<e;r++){var i=t[r];if(null!=i){var o=i.key;null!=o&&(n[o]=r)}}return n}(e,w)),null!=_){var S=y[_.key];if(null!=S){var A=e[S],C=null!=m&&S>=e.length-m.length||null==m&&o;u(t,A,_,a,c(e,w+1,l),o,d),f(t,s(A),l),e[S].skip=!0,null!=A.dom&&(l=A.dom)}else{l=i(t,_,a,d,l)}}k--}else w--,k--;if(k<b)break}r(t,n,b,k+1,a,l,d),h(e,g,w+1,n)}}function u(t,r,c,f,h,p,m){var x=r.tag;if(x===c.tag){if(c.state=r.state,c._state=r._state,c.events=r.events,!p&&function(t,e){var n,r;null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate&&(n=t.attrs.onbeforeupdate.call(t.state,t,e));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeupdate&&(r=t._state.onbeforeupdate.call(t.state,t,e));if(!(void 0===n&&void 0===r||n||r))return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,!0;return!1}(c,r))return;if("string"==typeof x)switch(null!=c.attrs&&(p?(c.state={},w(c.attrs,c,f)):k(c.attrs,c,f)),x){case"#":!function(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children);e.dom=t.dom}(r,c);break;case"<":!function(t,e,n,r){e.children!==n.children?(s(e),o(t,n,r)):(n.dom=e.dom,n.domSize=e.domSize)}(t,r,c,h);break;case"[":!function(t,e,n,r,i,o,a){l(t,e.children,n.children,r,i,o,a);var u=0,s=n.children;if(n.dom=null,null!=s){for(var c=0;c<s.length;c++){var f=s[c];null!=f&&null!=f.dom&&(null==n.dom&&(n.dom=f.dom),u+=f.domSize||1)}1!==u&&(n.domSize=u)}}(t,r,c,p,f,h,m);break;default:!function(t,r,i,o,a){var u=r.dom=t.dom;a=e(r)||a,"textarea"===r.tag&&(null==r.attrs&&(r.attrs={}),null!=r.text&&(r.attrs.value=r.text,r.text=void 0));(function(t,e,n,r){if(null!=n)for(var i in n)y(t,i,e&&e[i],n[i],r);if(null!=e)for(var i in e)null!=n&&i in n||("className"===i&&(i="class"),"o"!==i[0]||"n"!==i[1]||g(i)?"key"!==i&&t.dom.removeAttribute(i):b(t,i,void 0))})(r,t.attrs,r.attrs,a),null!=r.attrs&&null!=r.attrs.contenteditable?d(r):null!=t.text&&null!=r.text&&""!==r.text?t.text.toString()!==r.text.toString()&&(t.dom.firstChild.nodeValue=r.text):(null!=t.text&&(t.children=[n("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=r.text&&(r.children=[n("#",void 0,void 0,r.text,void 0,void 0)]),l(u,t.children,r.children,i,o,null,a))}(r,c,p,f,m)}else!function(t,e,r,o,l,s,c){if(s)a(r,o);else{if(r.instance=n.normalize(r._state.view.call(r.state,r)),r.instance===r)throw Error("A view cannot return the vnode it received as argument");null!=r.attrs&&k(r.attrs,r,o),k(r._state,r,o)}null!=r.instance?(null==e.instance?i(t,r.instance,o,c,l):u(t,e.instance,r.instance,o,l,s,c),r.dom=r.instance.dom,r.domSize=r.instance.domSize):null!=e.instance?(v(e.instance,null),r.dom=void 0,r.domSize=0):(r.dom=e.dom,r.domSize=e.domSize)}(t,r,c,f,h,p,m)}else v(r,null),i(t,c,f,m,h)}function s(t){var e=t.domSize;if(null!=e||null==t.dom){var n=_.createDocumentFragment();if(e>0){for(var r=t.dom;--e;)n.appendChild(r.nextSibling);n.insertBefore(r,n.firstChild)}return n}return t.dom}function c(t,e,n){for(;e<t.length;e++)if(null!=t[e]&&null!=t[e].dom)return t[e].dom;return n}function f(t,e,n){n&&n.parentNode?t.insertBefore(e,n):t.appendChild(e)}function d(t){var e=t.children;if(null!=e&&1===e.length&&"<"===e[0].tag){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(null!=t.text||null!=e&&0!==e.length)throw new Error("Child node of a contenteditable must be trusted")}function h(t,e,n,r){for(var i=e;i<n;i++){var o=t[i];null!=o&&(o.skip?o.skip=!1:v(o,r))}}function v(t,e){function n(){if(++i===r&&(m(t),t.dom)){var n=t.domSize||1;if(n>1)for(var o=t.dom;--n;)p(o.nextSibling);p(t.dom),null==e||null!=t.domSize||function(t){return null!=t&&(t.oncreate||t.onupdate||t.onbeforeremove||t.onremove)}(t.attrs)||"string"!=typeof t.tag||(e.pool?e.pool.push(t):e.pool=[t])}}var r=1,i=0;if(t.attrs&&"function"==typeof t.attrs.onbeforeremove){null!=(o=t.attrs.onbeforeremove.call(t.state,t))&&"function"==typeof o.then&&(r++,o.then(n,n))}if("string"!=typeof t.tag&&"function"==typeof t._state.onbeforeremove){var o=t._state.onbeforeremove.call(t.state,t);null!=o&&"function"==typeof o.then&&(r++,o.then(n,n))}n()}function p(t){var e=t.parentNode;null!=e&&e.removeChild(t)}function m(t){if(t.attrs&&"function"==typeof t.attrs.onremove&&t.attrs.onremove.call(t.state,t),"string"!=typeof t.tag&&"function"==typeof t._state.onremove&&t._state.onremove.call(t.state,t),null!=t.instance)m(t.instance);else{var e=t.children;if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];null!=r&&m(r)}}}function y(t,e,n,r,i){var o=t.dom;if("key"!==e&&"is"!==e&&(n!==r||function(t,e){return"value"===e||"checked"===e||"selectedIndex"===e||"selected"===e&&t.dom===_.activeElement}(t,e)||"object"==typeof r)&&void 0!==r&&!g(e)){var a=e.indexOf(":");if(a>-1&&"xlink"===e.substr(0,a))o.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(a+1),r);else if("o"===e[0]&&"n"===e[1]&&"function"==typeof r)b(t,e,r);else if("style"===e)!function(t,e,n){e===n&&(t.style.cssText="",e=null);if(null==n)t.style.cssText="";else if("string"==typeof n)t.style.cssText=n;else{"string"==typeof e&&(t.style.cssText="");for(var r in n)t.style[r]=n[r];if(null!=e&&"string"!=typeof e)for(var r in e)r in n||(t.style[r]="")}}(o,n,r);else if(e in o&&!function(t){return"href"===t||"list"===t||"form"===t||"width"===t||"height"===t}(e)&&void 0===i&&!function(t){return t.attrs.is||t.tag.indexOf("-")>-1}(t)){if("value"===e){var l=""+r;if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===l&&t.dom===_.activeElement)return;if("select"===t.tag)if(null===r){if(-1===t.dom.selectedIndex&&t.dom===_.activeElement)return}else if(null!==n&&t.dom.value===l&&t.dom===_.activeElement)return;if("option"===t.tag&&null!=n&&t.dom.value===l)return}if("input"===t.tag&&"type"===e)return void o.setAttribute(e,r);o[e]=r}else"boolean"==typeof r?r?o.setAttribute(e,""):o.removeAttribute(e):o.setAttribute("className"===e?"class":e,r)}}function g(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function b(t,e,n){var r=t.dom,i="function"!=typeof x?n:function(t){var e=n.call(r,t);return x.call(r,t),e};if(e in r)r[e]="function"==typeof n?i:null;else{var o=e.slice(2);if(void 0===t.events&&(t.events={}),t.events[e]===i)return;null!=t.events[e]&&r.removeEventListener(o,t.events[e],!1),"function"==typeof n&&(t.events[e]=i,r.addEventListener(o,t.events[e],!1))}}function w(t,e,n){"function"==typeof t.oninit&&t.oninit.call(e.state,e),"function"==typeof t.oncreate&&n.push(t.oncreate.bind(e.state,e))}function k(t,e,n){"function"==typeof t.onupdate&&n.push(t.onupdate.bind(e.state,e))}var x,_=t.document,S=_.createDocumentFragment(),A={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};return{render:function(t,e){if(!t)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var r=[],i=_.activeElement,o=t.namespaceURI;null==t.vnodes&&(t.textContent=""),Array.isArray(e)||(e=[e]),l(t,t.vnodes,n.normalizeChildren(e),!1,r,null,"http://www.w3.org/1999/xhtml"===o?void 0:o),t.vnodes=e;for(var a=0;a<r.length;a++)r[a]();null!=i&&_.activeElement!==i&&i.focus()},setEventCallback:function(t){return x=t}}},h=function(t){function e(t){var e=i.indexOf(t);e>-1&&i.splice(e,2)}function n(){for(var t=1;t<i.length;t+=2)i[t]()}var r=d(t);r.setEventCallback(function(t){!1===t.redraw?t.redraw=void 0:n()});var i=[];return{subscribe:function(t,n){e(t),i.push(t,function(t){var e=0,n=null,r="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var i=Date.now();0===e||i-e>=16?(e=i,t()):null===n&&(n=r(function(){n=null,t(),e=Date.now()},16-(i-e)))}}(n))},unsubscribe:e,redraw:n,render:r.render}}(window);f.setCompletionCallback(h.redraw);l.mount=function(t){return function(e,r){if(null===r)return t.render(e,[]),void t.unsubscribe(e);if(null==r.view&&"function"!=typeof r)throw new Error("m.mount(element, component) expects a component, not a vnode");t.subscribe(e,function(){t.render(e,n(r))}),t.redraw()}}(h);var v=u,p=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var e=t.split("&"),n={},r={},i=0;i<e.length;i++){var o=e[i].split("="),a=decodeURIComponent(o[0]),l=2===o.length?decodeURIComponent(o[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var u=a.split(/\]\[?|\[/),s=n;a.indexOf("[")>-1&&u.pop();for(var c=0;c<u.length;c++){var f=u[c],d=u[c+1],h=""==d||!isNaN(parseInt(d,10)),v=c===u.length-1;if(""===f){null==r[a=u.slice(0,c).join()]&&(r[a]=0),f=r[a]++}null==s[f]&&(s[f]=v?l:h?[]:{}),s=s[f]}}return n},m=function(t){function e(e){var n=t.location[e].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===e&&"/"!==n[0]&&(n="/"+n),n}function n(t,e,n){var r=t.indexOf("?"),i=t.indexOf("#"),o=r>-1?r:i>-1?i:t.length;if(r>-1){var a=i>-1?i:t.length,l=p(t.slice(r+1,a));for(var u in l)e[u]=l[u]}if(i>-1){var s=p(t.slice(i+1));for(var u in s)n[u]=s[u]}return t.slice(0,o)}var r,i="function"==typeof t.history.pushState,o="function"==typeof setImmediate?setImmediate:setTimeout,a={prefix:"#!"};return a.getPath=function(){switch(a.prefix.charAt(0)){case"#":return e("hash").slice(a.prefix.length);case"?":return e("search").slice(a.prefix.length)+e("hash");default:return e("pathname").slice(a.prefix.length)+e("search")+e("hash")}},a.setPath=function(e,r,o){var l={},u={};if(e=n(e,l,u),null!=r){for(var c in r)l[c]=r[c];e=e.replace(/:([^\/]+)/g,function(t,e){return delete l[e],r[e]})}var f=s(l);f&&(e+="?"+f);var d=s(u);if(d&&(e+="#"+d),i){var h=o?o.state:null,v=o?o.title:null;t.onpopstate(),o&&o.replace?t.history.replaceState(h,v,a.prefix+e):t.history.pushState(h,v,a.prefix+e)}else t.location.href=a.prefix+e},a.defineRoutes=function(e,l,u){function s(){var r=a.getPath(),i={},o=n(r,i,i),s=t.history.state;if(null!=s)for(var c in s)i[c]=s[c];for(var f in e){var d=new RegExp("^"+f.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(d.test(o))return void o.replace(d,function(){for(var t=f.match(/:[^\/]+/g)||[],n=[].slice.call(arguments,1,-2),o=0;o<t.length;o++)i[t[o].replace(/:|\./g,"")]=decodeURIComponent(n[o]);l(e[f],i,r,f)})}u(r,i)}i?t.onpopstate=function(t){return function(){null==r&&(r=o(function(){r=null,t()}))}}(s):"#"===a.prefix.charAt(0)&&(t.onhashchange=s),s()},a};l.route=function(t,e){var r,i,o,a,l,u=m(t),s=function(t,s,c){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var f=function(){null!=r&&e.render(t,r(n(i,o.key,o)))},d=function(t){if(t===s)throw new Error("Could not resolve default route "+s);u.setPath(s,null,{replace:!0})};u.defineRoutes(c,function(t,e,n){var u=l=function(t,s){u===l&&(i=null==s||"function"!=typeof s.view&&"function"!=typeof s?"div":s,o=e,a=n,l=null,r=(t.render||function(t){return t}).bind(t),f())};t.view||"function"==typeof t?u({},t):t.onmatch?v.resolve(t.onmatch(e,n)).then(function(e){u(t,e)},d):u(t,"div")},d),e.subscribe(t,f)};return s.set=function(t,e,n){null!=l&&((n=n||{}).replace=!0),l=null,u.setPath(t,e,n)},s.get=function(){return a},s.prefix=function(t){u.prefix=t},s.link=function(t){t.dom.setAttribute("href",u.prefix+t.attrs.href),t.dom.onclick=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey||2===t.which)){t.preventDefault(),t.redraw=!1;var e=this.getAttribute("href");0===e.indexOf(u.prefix)&&(e=e.slice(u.prefix.length)),s.set(e,void 0,void 0)}}},s.param=function(t){return void 0!==o&&void 0!==t?o[t]:o},s}(window,h),l.withAttr=function(t,e,n){return function(r){e.call(n||this,t in r.currentTarget?r.currentTarget[t]:r.currentTarget.getAttribute(t))}};var y=d(window);l.render=y.render,l.redraw=h.redraw,l.request=f.request,l.jsonp=f.jsonp,l.parseQueryString=p,l.buildQueryString=s,l.version="1.1.5",l.vnode=n,t.exports=l}()}),r={view:function(t){return[n("header.head",[n(".logo"),n("nav.btn-group.f-r",[n("a[href='/'].btn.sm",{oncreate:n.route.link},n.trust('<i class="icon-home"></i>'),"Plans"),n("a[href='/keys'].btn.sm",{oncreate:n.route.link},n.trust('<i class="icon-lock"></i>'),"Keys")])]),n("main.main.container-fluid",t.children)]}},i={list:[],map:{},loadList:function(){return n.request({method:"GET",url:"/plan",withCredentials:!0}).then(function(t){i.list=t,i.list.forEach(function(t){return i.map[t.key]=t.name})})},current:{},load:function(t){return n.request({method:"GET",url:"/plan/"+t,withCredentials:!0}).then(function(t){i.current=t})},create:function(t){return n.request({method:"POST",url:"/plan",withCredentials:!0,data:JSON.stringify(t)})}},o={oninit:i.loadList,view:function(){return n("div",[n("h2","Available Plans"),n("a[href=/newplan].btn.sm.success",{oncreate:n.route.link},n.trust('<i class="icon-plus"></i>'),"Add Plan"),n("table.table.responsive.border.hover",[n("thead",n("tr",[n("th","ID"),n("th","Name"),n("th","")])),n("tbody",i.list.map(function(t){return n("tr",{onclick:function(){n.route.set("/plans/"+t.key)}},[n("td",{"data-th":"ID"},t.key),n("td",{"data-th":"Name"},t.name),n("td",{"data-th":"Actions"},[n("button.btn.sm",{onclick:function(e){e.preventDefault(),e.stopPropagation(),n.route.set("/newkey/"+t.key)}},n.trust('<i class="icon-plus"></i>'),"New Key")])])}))])])}},a=t(function(t){!function(){function e(){function t(){return arguments.length>0&&arguments[0]!==y&&n(t,arguments[0]),t._state.value}return function(t){t.constructor=e,t._state={id:m++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},t.map=t["fantasy-land/map"]=u,t["fantasy-land/ap"]=s,t["fantasy-land/of"]=e,t.valueOf=c,t.toJSON=f,t.toString=c,Object.defineProperties(t,{end:{get:function(){if(!t._state.endStream){var n=e();n.map(function(e){return!0===e&&(l(t),n._state.unregister=function(){l(n)}),e}),t._state.endStream=n}return t._state.endStream}}})}(t),arguments.length>0&&arguments[0]!==y&&n(t,arguments[0]),t}function n(t,e){r(t,e);for(var n in t._state.deps)i(t._state.deps[n],!1);null!=t._state.unregister&&t._state.unregister(),function(t){t._state.changed=!1;for(var e in t._state.deps)t._state.deps[e]._state.changed=!1}(t)}function r(t,e){t._state.value=e,t._state.changed=!0,2!==t._state.state&&(t._state.state=1)}function i(t,e){var n=t._state.parents;if(n.length>0&&n.every(h)&&(e||n.some(v))){var i=t._state.derive();if(i===y)return!1;r(t,i)}}function o(t,n){if(!n.every(d))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return function(t,e,n){var r=t._state;return r.derive=n,r.parents=e.filter(p),a(t,r.parents),i(t,!0),t}(e(),n,function(){return t.apply(this,n.concat([n.filter(v)]))})}function a(t,e){for(var n=0;n<e.length;n++)e[n]._state.deps[t._state.id]=t,a(t,e[n]._state.parents)}function l(t){for(var e=0;e<t._state.parents.length;e++){delete t._state.parents[e]._state.deps[t._state.id]}for(var n in t._state.deps){var r=t._state.deps[n],i=r._state.parents.indexOf(t);i>-1&&r._state.parents.splice(i,1)}t._state.state=2,t._state.deps={}}function u(t){return o(function(e){return t(e())},[this])}function s(t){return o(function(t,e){return t()(e())},[t,this])}function c(){return this._state.value}function f(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function d(t){return t._state}function h(t){return 1===t._state.state}function v(t){return t._state.changed}function p(t){return 2!==t._state.state}var m=0,y={};e["fantasy-land/of"]=e,e.merge=function(t){return o(function(){return t.map(function(t){return t()})},t)},e.combine=o,e.scan=function(t,e,n){var r=o(function(n){return e=t(e,n._state.value)},[n]);return 0===r._state.state&&r(e),r},e.scanMerge=function(t,e){var n=t.map(function(t){var e=t[0];return 0===e._state.state&&e(void 0),e});return o(function(){var r=arguments[arguments.length-1];return n.forEach(function(n,i){r.indexOf(n)>-1&&(e=t[i][1](e,n._state.value))}),e},n)},e.HALT=y,t.exports=e}()}),l={name:a(""),buckets:[],oninit:function(t){},view:function(t){return n("div",[n("h2","Create a new Plan"),n("form",{onsubmit:t.state.save.bind(t.state)},[n(".form-element.form-group",[n("input[type=text][placeholder=Plan name].form-field",{oninput:n.withAttr("value",t.state.name)}),n("button.btn.sm.success",{onclick:function(e){return e.preventDefault(),t.state.buckets.push({name:a(""),hour:a(""),day:a(""),month:a("")})}},"Add bucket")]),n("table.table.responsive.border.hover",[n("thead",n("tr",[n("th","Bucket"),n("th","Hour"),n("th","Day"),n("th","Month"),n("th","")])),n("tbody",t.state.buckets.map(function(e,r){return n("tr",[n("td",{"data-th":"Bucket"},n("input[placeholder=Name]",{value:e.name,oninput:n.withAttr("value",e.name)})),n("td",{"data-th":"Hour"},n("input[type=number][placeholder=Hour]",{value:e.hour,oninput:n.withAttr("value",e.hour)})),n("td",{"data-th":"Day"},n("input[type=number][placeholder=Day]",{value:e.day,oninput:n.withAttr("value",e.day)})),n("td",{"data-th":"Month"},n("input[type=number][placeholder=Month]",{value:e.month,oninput:n.withAttr("value",e.month)})),n("td",{"data-th":"Remove"},[n("button.btn.sm.error",{onclick:function(){t.state.buckets.splice(r,1)}},n.trust('<i class="icon-bin"></i>'),"Delete")])])}))]),n("button.btn.sm.success","Save")])])},save:function(t){t.preventDefault();var e,r,o,a={name:this.name(),refills:{}},l=this.buckets,u=["hour","day","month"];for(r=0;r<l.length;++r){for(e={},o=0;o<u.length;++o)l[r].hasOwnProperty(u[o])&&(e[u[o]]=parseInt(l[r][u[o]]()));a.refills[l[r].name]=e}return i.create(a).then(function(){return n.route.set("/")}),!1}},u={oninit:function(t){return i.load(t.attrs.plan)},view:function(){return i.current&&n("div",[i.current.name&&n("h2","Request limits in ",i.current.name),n("table.table.responsive.border.hover",[n("thead",n("tr",[n("th","Bucket"),n("th","Hour"),n("th","Day"),n("th","Month")])),n("tbody",i.current.refills&&Object.keys(i.current.refills).map(function(t){return n("tr",[n("td",{"data-th":"Bucket"},t),n("td",{"data-th":"Hour"},i.current.refills[t].hour),n("td",{"data-th":"Day"},i.current.refills[t].day),n("td",{"data-th":"Month"},i.current.refills[t].month)])}))])])}},s={list:[],loadList:function(){return n.request({method:"GET",url:"/key",withCredentials:!0}).then(function(t){s.list=t.sort(function(t,e){return t.plan<e.plan})})},create:function(t){return n.request({method:"POST",url:"/key/"+t,withCredentials:!0})},changePlan:function(t,e){return n.request({method:"PUT",url:"/key/"+t+"/"+e,withCredentials:!0})},disable:function(t){return n.request({method:"DELETE",url:"/key/"+t,withCredentials:!0})}},c={key:null,oninit:function(t){return s.create(t.attrs.id).then(function(e){return t.state.key=e})},view:function(t){return n("div",t.state.key&&[n(".key",t.state.key.client_id),n(".key",t.state.key.client_secret)])||n(".key","Generating key")}},f={oninit:i.loadList().then(s.loadList),view:function(){return n("div",[n("h2","Available Api Keys"),n("table.table.responsive.border.hover",[n("thead",n("tr",[n("th","Key"),n("th","Plan"),n("th","Active"),n("th","")])),n("tbody",s.list.map(function(t){return n("tr",[n("td",{"data-th":"Key"},t.key),n("td",{"data-th":"Plan"},i.map[t.plan]),n("td",{"data-th":"Active"},t.active),n("td",{"data-th":"Actions"},n(".btn-group",[n("button.btn.sm",{onclick:function(){n.route.set("/editkey/"+t.key)}},n.trust('<i class="icon-tag"></i>'),"Change Plan"),n("button.btn.sm.error",{onclick:function(){s.disable(t.key).then(s.loadList)}},n.trust('<i class="icon-bin"></i>'),"Disable")]))])}))])])}},d={oninit:i.loadList,view:function(t){return n("div",[n("h2","Select Plan for Api Key"),n("h2",t.attrs.id),n(".btn-group",i.list.map(function(e){return n("button.btn.sm",{onclick:function(){s.changePlan(t.attrs.id,e.key).then(function(){return i.loadList().then(s.loadList),n.route.set("/keys")})}},e.name)}))])}};n.route.prefix(""),n.route(document.body,"/",{"/":{render:function(){return n(r,n(o))}},"/plans/:plan":{render:function(t){return n(r,n(u,t.attrs))}},"/newplan":{render:function(t){return n(r,n(l,t.attrs))}},"/newkey/:id":{render:function(t){return n(r,n(c,t.attrs))}},"/keys":{render:function(t){return n(r,n(f,t.attrs))}},"/editkey/:id":{render:function(t){return n(r,n(d,t.attrs))}}})}();
//# sourceMappingURL=app.min.js.map
